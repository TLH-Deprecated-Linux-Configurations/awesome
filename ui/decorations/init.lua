--  _____                               __   __
-- |     \.-----.----.-----.----.---.-.|  |_|__|.-----.-----.-----.
-- |  --  |  -__|  __|  _  |   _|  _  ||   _|  ||  _  |     |__ --|
-- |_____/|_____|____|_____|__| |___._||____|__||_____|__|__|_____|
-- ########################################################################
-- ########################################################################
-- ########################################################################
local gears = require('gears')
local awful = require('awful')
local beautiful = require('beautiful')
local xresources = require('beautiful.xresources')
local dpi = xresources.apply_dpi
local helpers = require('helpers')
-- ########################################################################
-- ########################################################################
-- ########################################################################

local tb_ops = {}
-- ########################################################################
-- ########################################################################
-- ########################################################################
local add_decorations = function(c)
    require('ui.decorations.top')(c)
end
-- ########################################################################
-- ########################################################################
-- ########################################################################
tb_ops.enable_tb = function(c)
    -- if c.class ~= "music" then add_decorations(c) end
    c.titlebars = true
    awful.titlebar.show(c, 'top')
    awful.titlebar.show(c, 'bottom')
    awful.titlebar.show(c, 'left')
    awful.titlebar.show(c, 'right')
    add_decorations(c)
end
-- ########################################################################
-- ########################################################################
-- ########################################################################
tb_ops.disable_tb = function(c)
    awful.titlebar.hide(c, 'top')
    awful.titlebar.hide(c, 'bottom')
    awful.titlebar.hide(c, 'left')
    awful.titlebar.hide(c, 'right')
    c.border_width = beautiful.border_width
end
-- ########################################################################
-- ########################################################################
-- ########################################################################
client.connect_signal(
    'request::titlebars',
    function(c)
        client.connect_signal(
            'property::floating',
            function(c)
                tb_ops.enable_tb(c)
            end
        )
        -- ########################################################################
        -- ########################################################################
        -- ########################################################################
        client.connect_signal(
            'manage',
            function(c)
                tb_ops.enable_tb(c)
            end
        )
        -- ########################################################################
        -- ########################################################################
        -- ########################################################################
        tag.connect_signal(
            'property::layout',
            function(t)
                local clients = t:clients()
                for k, c in pairs(clients) do
                    tb_ops.enable_tb(c)
                end
            end
        )
    end
)
-- ########################################################################
-- ########################################################################
-- ########################################################################
return tb_ops
